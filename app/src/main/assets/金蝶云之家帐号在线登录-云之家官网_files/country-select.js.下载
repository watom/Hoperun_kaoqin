define(["countryArray"],function(l){var a=Zepto,u=l.length,c=[{firstCode:"Z",code:"86",country:"中国"},{firstCode:"X",code:"852",country:"香港地区"},{firstCode:"T",code:"886",country:"台湾地区"},{firstCode:"M",code:"60",country:"马来西亚"},{firstCode:"R",code:"81",country:"日本"},{firstCode:"M",code:"1",country:"美国"}],r=function(){var t=navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?"ios":navigator.userAgent.match(/Android/i)?"android":"";return"ios"==t||"android"==t},d=function(t){for(var n,e,i=t.length,o=0,r="";o<i;o++)e=t[o],n&&n==e.firstCode||(r+='<li class="country-list-title">'+(n=e.firstCode)+"</li>"),r+='<li class="country-list-item"><span class="country-list-name">'+e.country+'</span><span class="country-list-code">+'+e.code+"</span></li>";return r},y=function(){for(var t,n=c.length,e=0,i='<li class="country-list-title">推荐登录地区</li>';e<n;e++)i+='<li class="country-list-item"><span class="country-list-name">'+(t=c[e]).country+'</span><span class="country-list-code">+'+t.code+"</span></li>";return i+d(l)},s={flag:!1,_getElement:!1,getElement:function(){return this._getElement?this._getElement:this._getElement={countryList:document.getElementById("country-list"),countryUl:document.getElementById("country-ul"),rightBar:document.getElementById("rightBar"),barLi:document.getElementById("rightBar").getElementsByTagName("li"),countryLi:document.getElementById("country-ul").getElementsByTagName("li"),originLi:document.querySelectorAll(".startOrigin"),cancel:document.getElementById("cancel")}},initList:function(t){var n;n=window.devicePixelRatio,1.5<=window.devicePixelRatio&&(n=2),document.documentElement.setAttribute("data-dpr",n),document.documentElement.style.fontSize=document.documentElement.clientWidth/7.5+"px";var e,i,o,r=[];i='<li class="recommend">推荐登录地区</li>'+c.map(function(t){return'<li class="getCode"><span class="country">'+t.country+'</span><span class="zonecode">+'+t.code+"</span></li>"}).join(""),e=l.map(function(t){return-1!=r.indexOf(t.firstCode)?'<li class="getCode"><span class="country">'+t.country+'</span><span class="zonecode">+'+t.code+"</span></li>":r.push(t.firstCode)&&'<li class="startOrigin">'+t.firstCode+'</li><li class="getCode"><span class="country">'+t.country+'</span><span class="zonecode">+'+t.code+"</span></li>"}).join(""),o=r.map(function(t){return"<li>"+t+"</li>"}).join(""),a('<div class="country-close"><span class="country-close-icon">取消</span></div><div id="country-list"><ul id="country-ul">'+i+e+' </ul><ul id="rightBar">'+o+"</ul></div>").appendTo(a("body")),this.initBarHeight(),this.load(t),this.flag=!0},initBarHeight:function(){var t=[].slice.call(this.getElement().barLi),n=t.length,e=(this.getElement().rightBar.clientHeight-this.getElement().rightBar.offsetTop)/n;t.forEach(function(t,n){t.style.lineHeight=t.style.height=e+"px",t.index=n})},show:function(t){return this.flag?a("#country-list,.country-close").show():this.initList(t),this},hide:function(){a("#country-list,.country-close").hide()},load:function(e){var i=this,n=new IScroll("#country-list",{click:!0}),t=(this.getElement().barLi,this.getElement().rightBar),o=document.querySelectorAll(".startOrigin");a(t).on("tap",function(t){a(t.target);"li"==t.target.nodeName.toLowerCase()&&n.scrollToElement(o[t.target.index],100),t.stopPropagation()}),a("#country-ul").find(".getCode").on("tap",function(){var t=a.trim(a(this).find(".country").text()),n=a.trim(a(this).find(".zonecode").text());e({country:t,code:n}),i.hide()}),a(".country-close-icon").on("tap",function(){i.hide()})}};return function(t,n,e,i){return r()?(o=t,s.show(o)):function(e,i,t,n){i=i||"#jsCountryList",t=t||"#jsCountryUl";var o,r=a(n=n||"#jsCountrySearch"),c=r.val(),s=a(t);return s.html(y()),r.on("input propertychange",function(){clearTimeout(o),o=setTimeout(function(){var t=r.val(),n=[],e=0;if(a.trim(t)!=a.trim(c)){if(!(c=t))return s.html(y());for(;e<u;e++)(-1<l[e].country.indexOf(t)||-1<l[e].code.indexOf(t))&&n.push(l[e]);return s.html(d(n))}},300)}),s.on("click",".country-list-item",function(t){var n=a(this);e({country:n.find(".country-list-name").text(),code:n.find(".country-list-code").text()}),a(i).hide()}),{show:function(){a(i).show()},hide:function(){a(i).hide()}}}(t,n,e,i);var o}});